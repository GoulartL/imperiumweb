!function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=149)}({149:function(t,e,a){t.exports=a(150)},150:function(t,e){$(document).ready((function(){var t=$("#tbPayments").DataTable({language:traducao,processing:!0,serverSide:!0,ajax:"/api/pagamentos",columns:[{data:"id",name:"id",className:"status"},{data:"supplier_name",name:"supplier_name"},{data:"description",name:"description"},{data:"value",name:"value",render:$.fn.dataTable.render.number(".",",",2,"R$")},{data:"due_date",name:"due_date"},{data:"portion",name:"portion"},{data:"emission",name:"emission"},{data:"payment_date",name:"payment_date"},{data:"payment_value",name:"payment_value",render:$.fn.dataTable.render.number(".",",",2,"R$")},{data:"specie_name",name:"specie_name"},{data:"observation",name:"observation"},{data:null,className:"text-nowrap",render:function(t,e,a){return"<button class='btn btn-primary btn-sm mx-1 action'><i class='fas fa-dollar-sign action-table'></i></button><button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"}}],columnDefs:[{className:"text-nowrap-pc",targets:"_all"},{orderable:!1,targets:[11]},{targets:[4,6,7],render:$.fn.dataTable.render.moment("DD/MM/YYYY")}],createdRow:function(t,e,a){e.payment_value>=e.value?$(t).find("td:eq(0)").addClass("tb-success"):moment(e.due_date).isBefore(moment())?$(t).find("td:eq(0)").addClass("tb-error"):e.payment_value<e.value&&e.payment_value?$(t).find("td:eq(0)").addClass("tb-warning"):$(t).find("td:eq(0)").addClass("tb-none")},dom:"<'row'<'col-sm-12 col-md-6 toolbar text-center text-sm-left'><'col-sm-12 col-md-6 search-datatables'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",responsive:{details:{renderer:function(t,e,a){var n=$.map(a,(function(t,e){return t.hidden?'<tr data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><td class="font-weight-bold">'+t.title+":</td> <td>"+t.data+"</td></tr>":""})).join("");return!!n&&$('<table class="w-100 p-0 table-sm"/>').append(n)}}}}),e=$("#tbPortions").DataTable({language:traducao,dom:"t",paging:!1,columnDefs:[{className:"text-nowrap-pc",targets:"_all"},{orderable:!1,targets:[3]}]}),a={minimumFractionDigits:2};$("div.toolbar").html("<button class='btn waves-effect waves-light btn-primary mb-2' data-toggle='modal' data-target='#mdCrud' id='mdAddPayments'><i class='fas fa-plus mr-2'></i>Novo Pagamento</button>"),$("#mdAddPayments").on("click",(function(){$("#mdDivValue, #mdDivDueDate").hide(),$("#mdPortionDiv, #mdDivSupplier").show(),$("#mdCrudTitle").html("Novo Pagamento"),e.clear().draw(),$("form#paymentsForm :input").each((function(){$(this).val("").trigger("change")})),$("#mdInputEmission").datepicker("update",moment().format("DD/MM/YYYY"))})),$("#tbPayments tbody").on("click",".edit",(function(){var e=t.row($(this).parents("tr")).data();$("#mdCrudTitle").html("Editar Pagamento"),$("#mdInputID").val(e.id),$("#mdInputDueDate").datepicker("update",moment(e.due_date).format("DD/MM/YYYY")),$("#mdInputEmission").datepicker("update",moment(e.emission).format("DD/MM/YYYY")),$("#mdInputDescription").val(e.description),$("#mdInputValue").val(e.value),$("#mdInputPortions").val(e.portion),$("#mdInputSuppliers").append(new Option(e.supplier_name,e.supplier,!0,!0)).trigger("change"),$("#mdInputSpecies").append(new Option(e.specie_name,e.species,!0,!0)).trigger("change"),$("#mdPortionDiv, #mdDivSupplier").hide(),$("#mdDivValue, #mdDivDueDate").show(),$("#mdCrud").modal("show")})),$("#tbPayments tbody").on("click",".action",(function(){var e=t.row($(this).parents("tr")).data();$("#mdPaymentTitle").html("Lançar Pagamento"),$("#mdPayID").html(e.id),$("#mdPaymentID").val(e.id),$("#mdInputID").val(""),$("#mdPaySupplier").html(e.supplier+" - "+e.supplier_name),$("#mdPayDescription").html(e.description),$("#mdPayDueDate").html(moment(e.due_date).format("DD/MM/YYYY")),$("#mdPayPortion").html(e.portion),$("#mdPayValue").html(e.value),$("#mdPayment").modal("show")})),$("#tbPayments tbody").on("click",".remove",(function(){var e=t.row($(this).parents("tr")).data();customConfirm("Confirmar ação?","Você está prestes a excluir o pagamento ["+e.id+"]",(function(){$.ajax({type:"DELETE",url:"/api/pagamentos/remover/"+e.id}).done((function(e){response=JSON.parse(e),toastAlert(response.status,response.message),t.ajax.reload()}))}))})),$("#paymentsForm").on("submit",(function(a){return a.preventDefault(),""==$("#mdInputID").val()?$.ajax({type:"POST",url:"/api/pagamentos/guardar",data:JSON.stringify({header:$(this).serializeArray(),payments:e.rows().data().toArray()})}).done((function(e){if(response=JSON.parse(e),toastAlert(response.status,response.message),clearAllInputsValidations("paymentsForm"),"success"==response.status)t.ajax.reload(),$("#mdCrud").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})):$.ajax({type:"PUT",url:"/api/pagamentos/editar/"+$("#mdInputID").val(),data:$(this).serializeArray()}).done((function(e){if(response=JSON.parse(e),toastAlert(response.status,response.message),clearAllInputsValidations("paymentsForm"),"success"==response.status)t.ajax.reload(),$("#mdCrud").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})),!1})),$("#paymentActionForm").on("submit",(function(e){return e.preventDefault(),""!=$("#mdPaymentID").val()&&$.ajax({type:"PUT",url:"/api/pagamentos/editar/"+$("#mdPaymentID").val(),data:$(this).serializeArray()}).done((function(e){if(response=JSON.parse(e),toastAlert(response.status,response.message),clearAllInputsValidations("paymentActionForm"),"success"==response.status)t.ajax.reload(),$("#mdPayment").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})),!1})),$("#mdCrud").on("hidden.bs.modal",(function(t){clearAllInputsValues("paymentsForm")})),$(".select-server-side").each((function(t){$(this).select2({ajax:{delay:250,theme:"bootstrap",url:"/api/"+$(this).attr("data-values")+"/select",dataType:"json",data:function(t){return{search:t.term,page:t.page||1}}}})})),$(".select-client-side").select2({dropdownPosition:"below"}),$("#mdAddPortions").on("click",(function(t){t.preventDefault();var n=$("#mdInputPortions").val(),r=$("#mdInputTotal").val(),o=$("#mdInputFirstDueDate").val(),s=moment(o,"DD/MM/YYYY");if(n&&r&&o){for(var i=0;i<n;i++)s=0==i?s:moment(s).add(1,"months"),e.row.add([i+1,(r/n).toLocaleString("pt-BR",a),s.format("DD/MM/YYYY"),"<button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"]).draw();$("#mdInputTotal, #mdInputPortions, #mdInputFirstDueDate").val("")}else toastAlert("warning",'Preencha os campos "Total", "Parcelas" e "1° Vencimento" para poder incluir parcelas.')})),$("#tbPortions tbody").on("click",".edit",(function(t){t.preventDefault();var a=e.row($(this).parents("tr")).data();e.row($(this).parents("tr")).data([a[0],"<input type='text' value='"+a[1]+"'/>","<input class='input-date' type='text' value='"+moment(a[2],"DD/MM/YYYY").format("DD/MM/YYYY")+"'>","<button class='btn btn-primary btn-sm mx-1 savePortionEdit'><i class='fas fa-check'></i></button>"])})),$("#tbPortions tbody").on("click",".savePortionEdit",(function(t){t.preventDefault();var a=e.row($(this).parents("tr")).data(),n=e.row($(this).parents("tr")).node();e.row($(this).parents("tr")).data([a[0],n.cells[1].children[0].value,n.cells[2].children[0].value,"<button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"])})),$("#tbPortions tbody").on("click",".remove",(function(t){t.preventDefault(),e.row($(this).parents("tr")).remove().draw(),e.rows().every((function(t,a,n){e.cell(t,0).data(++n)})).draw()})),$("#tbPortions").on("focus",".input-date",(function(){$(this).datepicker({format:"dd/mm/yyyy",language:"pt-BR",autoclose:!0,todayHighlight:!0})}))}))}});