!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=147)}({147:function(e,t,a){e.exports=a(148)},148:function(e,t){$(document).ready((function(){var e=$("#tbReceipts").DataTable({language:traducao,processing:!0,serverSide:!0,ajax:"/api/recebimentos",columns:[{data:"id",name:"id",className:"status"},{data:"customer_name",name:"customer_name"},{data:"description",name:"description"},{data:"value",name:"value",render:$.fn.dataTable.render.number(".",",",2,"R$")},{data:"due_date",name:"due_date"},{data:"portion",name:"portion"},{data:"emission",name:"emission"},{data:"receipt_date",name:"receipt_date"},{data:"receipt_value",name:"receipt_value",render:$.fn.dataTable.render.number(".",",",2,"R$")},{data:"specie_name",name:"specie_name"},{data:"observation",name:"observation"},{data:null,className:"text-nowrap",render:function(e,t,a){return"<button class='btn btn-primary btn-sm mx-1 action'><i class='fas fa-dollar-sign action-table'></i></button><button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"}},{data:"client",name:"client"},{data:"species",name:"species"}],columnDefs:[{className:"text-nowrap-pc",targets:"_all"},{orderable:!1,targets:[11]},{targets:[12,13],visible:!1},{targets:[4,6,7],render:$.fn.dataTable.render.moment("DD/MM/YYYY")}],createdRow:function(e,t,a){t.receipt_value>=t.value?$(e).find("td:eq(0)").addClass("tb-success"):moment(t.due_date).isBefore(moment())?$(e).find("td:eq(0)").addClass("tb-error"):t.receipt_value<t.value&&t.receipt_value?$(e).find("td:eq(0)").addClass("tb-warning"):$(e).find("td:eq(0)").addClass("tb-none")},dom:"<'row'<'col-sm-12 col-md-6 toolbar text-center text-sm-left'><'col-sm-12 col-md-6 search-datatables'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",responsive:{details:{renderer:function(e,t,a){var n=$.map(a,(function(e,t){return e.hidden?'<tr data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><td class="font-weight-bold">'+e.title+":</td> <td>"+e.data+"</td></tr>":""})).join("");return!!n&&$('<table class="w-100 p-0 table-sm"/>').append(n)}}}}),t=$("#tbPortions").DataTable({language:traducao,dom:"t",paging:!1,columnDefs:[{className:"text-nowrap-pc",targets:"_all"},{orderable:!1,targets:[3]}]}),a={minimumFractionDigits:2};$("div.toolbar").html("<button class='btn waves-effect waves-light btn-primary mb-2' data-toggle='modal' data-target='#mdCrud' id='mdAddReceipts'><i class='fas fa-plus mr-2'></i>Novo Recebimento</button>"),$("#mdAddReceipts").on("click",(function(){$("#mdDivValue, #mdDivDueDate").hide(),$("#mdPortionDiv, #mdDivCustomer").show(),$("#mdCrudTitle").html("Novo Recebimento"),t.clear().draw(),$("form#receiptsForm :input").each((function(){$(this).val("").trigger("change")})),$("#mdInputEmission").datepicker("update",moment().format("DD/MM/YYYY"))})),$("#tbReceipts tbody").on("click",".edit",(function(){var t=e.row($(this).parents("tr")).data();$("#mdCrudTitle").html("Editar Recebimento"),$("#mdInputID").val(t.id),$("#mdInputDueDate").datepicker("update",moment(t.due_date).format("DD/MM/YYYY")),$("#mdInputEmission").datepicker("update",moment(t.emission).format("DD/MM/YYYY")),$("#mdInputDescription").val(t.description),$("#mdInputValue").val(t.value),$("#mdInputPortions").val(t.portion),$("#mdInputCustomers").append(new Option(t.customer_name,t.client,!0,!0)).trigger("change"),$("#mdInputSpecies").append(new Option(t.specie_name,t.species,!0,!0)).trigger("change"),$("#mdPortionDiv, #mdDivCustomer").hide(),$("#mdDivValue, #mdDivDueDate").show(),$("#mdCrud").modal("show")})),$("#tbReceipts tbody").on("click",".action",(function(){var t=e.row($(this).parents("tr")).data();$("#mdReceiptTitle").html("Lançar Recebimento"),$("#mdRecID").html(t.id),$("#mdReceiptID").val(t.id),$("#mdInputID, #mdRecInputReceiptDate, #mdRecInputReceiptValue").val(""),$("#mdRecCustomer").html(t.client+" - "+t.customer_name),$("#mdRecDescription").html(t.description),$("#mdRecDueDate").html(moment(t.due_date).format("DD/MM/YYYY")),$("#mdRecPortion").html(t.portion),$("#mdRecValue").html(t.value),$("#mdReceipt").modal("show")})),$("#tbReceipts tbody").on("click",".remove",(function(){var t=e.row($(this).parents("tr")).data();customConfirm("Confirmar ação?","Você está prestes a excluir o recebimento ["+t.id+"]",(function(){$.ajax({type:"DELETE",url:"/api/recebimentos/remover/"+t.id}).done((function(t){response=JSON.parse(t),toastAlert(response.status,response.message),e.ajax.reload()}))}))})),$("#receiptsForm").on("submit",(function(a){return a.preventDefault(),""==$("#mdInputID").val()?$.ajax({type:"POST",url:"/api/recebimentos/guardar",data:JSON.stringify({header:$(this).serializeArray(),receipts:t.rows().data().toArray()})}).done((function(t){if(response=JSON.parse(t),toastAlert(response.status,response.message),clearAllInputsValidations("receiptsForm"),"success"==response.status)e.ajax.reload(),$("#mdCrud").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})):$.ajax({type:"PUT",url:"/api/recebimentos/editar/"+$("#mdInputID").val(),data:$(this).serializeArray()}).done((function(t){if(response=JSON.parse(t),toastAlert(response.status,response.message),clearAllInputsValidations("receiptsForm"),"success"==response.status)e.ajax.reload(),$("#mdCrud").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})),!1})),$("#receiptActionForm").on("submit",(function(t){return t.preventDefault(),""!=$("#mdReceiptID").val()&&$.ajax({type:"PUT",url:"/api/recebimentos/editar/"+$("#mdReceiptID").val(),data:$(this).serializeArray()}).done((function(t){if(response=JSON.parse(t),toastAlert(response.status,response.message),clearAllInputsValidations("receiptActionForm"),"success"==response.status)e.ajax.reload(),$("#mdReceipt").modal("hide");else for(var a in response.data)invalidateInput(a,response.data[a][0])})),!1})),$("#mdCrud").on("hidden.bs.modal",(function(e){clearAllInputsValues("receiptsForm")})),$(".select-server-side").each((function(e){$(this).select2({ajax:{delay:250,theme:"bootstrap",url:"/api/"+$(this).attr("data-values")+"/select",dataType:"json",data:function(e){return{search:e.term,page:e.page||1}}}})})),$(".select-client-side").select2({dropdownPosition:"below"}),$("#mdAddPortions").on("click",(function(e){e.preventDefault();var n=$("#mdInputPortions").val(),r=$("#mdInputTotal").val(),o=$("#mdInputFirstDueDate").val(),s=moment(o,"DD/MM/YYYY");if(n&&r&&o){for(var i=0;i<n;i++)s=0==i?s:moment(s).add(1,"months"),t.row.add([i+1,(r/n).toLocaleString("pt-BR",a),s.format("DD/MM/YYYY"),"<button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"]).draw();$("#mdInputTotal, #mdInputPortions, #mdInputFirstDueDate").val("")}else toastAlert("warning",'Preencha os campos "Total", "Parcelas" e "1° Vencimento" para poder incluir parcelas.')})),$("#tbPortions tbody").on("click",".edit",(function(e){e.preventDefault();var a=t.row($(this).parents("tr")).data();t.row($(this).parents("tr")).data([a[0],"<input type='text' value='"+a[1]+"'/>","<input class='input-date' type='text' value='"+moment(a[2],"DD/MM/YYYY").format("DD/MM/YYYY")+"'>","<button class='btn btn-primary btn-sm mx-1 savePortionEdit'><i class='fas fa-check'></i></button>"])})),$("#tbPortions tbody").on("click",".savePortionEdit",(function(e){e.preventDefault();var a=t.row($(this).parents("tr")).data(),n=t.row($(this).parents("tr")).node();t.row($(this).parents("tr")).data([a[0],n.cells[1].children[0].value,n.cells[2].children[0].value,"<button class='btn btn-primary btn-sm mx-1 edit'><i class='fas fa-edit action-table'></i></button><button class='btn btn-primary btn-sm mx-1 remove'><i class='fas fa-trash action-table'></i></button>"])})),$("#tbPortions tbody").on("click",".remove",(function(e){e.preventDefault(),t.row($(this).parents("tr")).remove().draw(),t.rows().every((function(e,a,n){t.cell(e,0).data(++n)})).draw()})),$("#tbPortions").on("focus",".input-date",(function(){$(this).datepicker({format:"dd/mm/yyyy",language:"pt-BR",autoclose:!0,todayHighlight:!0})}))}))}});